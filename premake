# /bin/sh
# Licensed under the BSD 3-Clause License. Authors: Teng Zhang (zhteg4@gmail.com)
: '
Set up the environment for the sh, workflow, driver module, and submodule directories.

Usage:
  . premake
  source premake
'

# Shell Type and Root Directory
if [ $(basename $0) = 'premake' ]
then
  PREMAKE="$0" && echo "Shell Type: zsh"
elif [ $BASH_SOURCE ]
  then
  PREMAKE=${BASH_SOURCE[0]} && echo "Shell Type: POSIX"
else
  x="$(lsof -p $$ -Fn0 | tail -1 | tr -d "\0")" && PREMAKE=${x#*n} && echo "Shell Type: dash"
fi
[ ! -f $PREMAKE ] && echo "Cannot locate this premake script" && return
NEMD_SRC="$(readlink -f ${PREMAKE} | xargs dirname)" && echo \$NEMD_SRC=$NEMD_SRC

# Packages: NEMD, LAMMPS, and ALAMODE
MOD=$NEMD_SRC/module && echo \$MOD=$MOD
[ -d "$MOD" ] && echo $PYTHONPATH | grep -q $MOD || export PYTHONPATH="$MOD${PYTHONPATH:+":$PYTHONPATH"}"

# Shell, Driver, Workflow, and Alamode
add_path() { echo $1 && [ -d "$1" ] && echo $PATH | grep -q "$1" || export PATH="$1${PATH:+":$PATH"}"; }
add_path $NEMD_SRC/sh
add_path $NEMD_SRC/driver
add_path $NEMD_SRC/workflow
add_path $NEMD_SRC/module/alamode/alamode/tools
